<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>一文看懂C#各版本新功能+代码演示 | Anmi Blog</title><meta name="description" content="一文看懂C#各版本新功能+代码演示"><meta name="keywords" content="Asp.Net,C#"><meta name="author" content="HJY"><meta name="copyright" content="HJY"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="一文看懂C#各版本新功能+代码演示"><meta name="twitter:description" content="一文看懂C#各版本新功能+代码演示"><meta name="twitter:image" content="https://Hjy-dev.github.io/img/logo/AspDotnet.png"><meta property="og:type" content="article"><meta property="og:title" content="一文看懂C#各版本新功能+代码演示"><meta property="og:url" content="https://hjy-dev.github.io/2020/03/01/%E4%B8%80%E6%96%87%E7%9C%8B%E6%87%82C-%E5%90%84%E7%89%88%E6%9C%AC%E6%96%B0%E5%8A%9F%E8%83%BD-%E4%BB%A3%E7%A0%81%E6%BC%94%E7%A4%BA/"><meta property="og:site_name" content="Anmi Blog"><meta property="og:description" content="一文看懂C#各版本新功能+代码演示"><meta property="og:image" content="https://Hjy-dev.github.io/img/logo/AspDotnet.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://hjy-dev.github.io/2020/03/01/%E4%B8%80%E6%96%87%E7%9C%8B%E6%87%82C-%E5%90%84%E7%89%88%E6%9C%AC%E6%96%B0%E5%8A%9F%E8%83%BD-%E4%BB%A3%E7%A0%81%E6%BC%94%E7%A4%BA/"><link rel="next" title="Mysql知识总结" href="https://hjy-dev.github.io/2020/03/01/Mysql%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"./search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Anmi Blog</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 清单</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 视频</span></a></li></ul></div></div></span><span class="pull_right" id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">64</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">36</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">15</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 清单</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 视频</span></a></li></ul></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#代码演示C-各版本新功能"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">代码演示C#各版本新功能</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#C-2-0版-2005"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">C# 2.0版 - 2005</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#泛型"><span class="toc_mobile_items-number">2.1.</span> <span class="toc_mobile_items-text">泛型</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#分部类型"><span class="toc_mobile_items-number">2.2.</span> <span class="toc_mobile_items-text">分部类型</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#匿名方法"><span class="toc_mobile_items-number">2.3.</span> <span class="toc_mobile_items-text">匿名方法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#可以为null的值类型"><span class="toc_mobile_items-number">2.4.</span> <span class="toc_mobile_items-text">可以为null的值类型</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#迭代器"><span class="toc_mobile_items-number">2.5.</span> <span class="toc_mobile_items-text">迭代器</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#协变和逆变"><span class="toc_mobile_items-number">2.6.</span> <span class="toc_mobile_items-text">协变和逆变</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#C-3-0版-2007"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text">C# 3.0版 - 2007</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#自动实现的属性"><span class="toc_mobile_items-number">3.1.</span> <span class="toc_mobile_items-text">自动实现的属性</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#匿名类型"><span class="toc_mobile_items-number">3.2.</span> <span class="toc_mobile_items-text">匿名类型</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#查询表达式（LINQ）"><span class="toc_mobile_items-number">3.3.</span> <span class="toc_mobile_items-text">查询表达式（LINQ）</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Lambda表达式"><span class="toc_mobile_items-number">3.4.</span> <span class="toc_mobile_items-text">Lambda表达式</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#表达式树"><span class="toc_mobile_items-number">3.5.</span> <span class="toc_mobile_items-text">表达式树</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#扩展方法"><span class="toc_mobile_items-number">3.6.</span> <span class="toc_mobile_items-text">扩展方法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#var"><span class="toc_mobile_items-number">3.7.</span> <span class="toc_mobile_items-text">var</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#分部方法"><span class="toc_mobile_items-number">3.8.</span> <span class="toc_mobile_items-text">分部方法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#对象和集合初始值设定项"><span class="toc_mobile_items-number">3.9.</span> <span class="toc_mobile_items-text">对象和集合初始值设定项</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#C-4-0版-2010"><span class="toc_mobile_items-number">4.</span> <span class="toc_mobile_items-text">C# 4.0版 - 2010</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#动态绑定"><span class="toc_mobile_items-number">4.1.</span> <span class="toc_mobile_items-text">动态绑定</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#命名参数-可选参数"><span class="toc_mobile_items-number">4.2.</span> <span class="toc_mobile_items-text">命名参数&#x2F;可选参数</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#泛型中的协变和逆变"><span class="toc_mobile_items-number">4.3.</span> <span class="toc_mobile_items-text">泛型中的协变和逆变</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#类型等效性和嵌入的互操作类型"><span class="toc_mobile_items-number">4.4.</span> <span class="toc_mobile_items-text">类型等效性和嵌入的互操作类型</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#C-5-0版-2012"><span class="toc_mobile_items-number">5.</span> <span class="toc_mobile_items-text">C# 5.0版 - 2012</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#异步编程"><span class="toc_mobile_items-number">5.1.</span> <span class="toc_mobile_items-text">异步编程</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#调用方信息"><span class="toc_mobile_items-number">5.2.</span> <span class="toc_mobile_items-text">调用方信息</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#C-6-0版-2015"><span class="toc_mobile_items-number">6.</span> <span class="toc_mobile_items-text">C# 6.0版 - 2015</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#静态导入"><span class="toc_mobile_items-number">6.1.</span> <span class="toc_mobile_items-text">静态导入</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#异常筛选器"><span class="toc_mobile_items-number">6.2.</span> <span class="toc_mobile_items-text">异常筛选器</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#自动初始化表达式"><span class="toc_mobile_items-number">6.3.</span> <span class="toc_mobile_items-text">自动初始化表达式</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Expression-bodied-函数成员"><span class="toc_mobile_items-number">6.4.</span> <span class="toc_mobile_items-text">Expression-bodied 函数成员</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Null传播器"><span class="toc_mobile_items-number">6.5.</span> <span class="toc_mobile_items-text">Null传播器</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#字符串内插"><span class="toc_mobile_items-number">6.6.</span> <span class="toc_mobile_items-text">字符串内插</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#nameof表达式"><span class="toc_mobile_items-number">6.7.</span> <span class="toc_mobile_items-text">nameof表达式</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#索引初始值设定项"><span class="toc_mobile_items-number">6.8.</span> <span class="toc_mobile_items-text">索引初始值设定项</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#C-7-0版-2017"><span class="toc_mobile_items-number">7.</span> <span class="toc_mobile_items-text">C# 7.0版 - 2017</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#out变量"><span class="toc_mobile_items-number">7.1.</span> <span class="toc_mobile_items-text">out变量</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#元组和析构函数"><span class="toc_mobile_items-number">7.2.</span> <span class="toc_mobile_items-text">元组和析构函数</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#模式匹配"><span class="toc_mobile_items-number">7.3.</span> <span class="toc_mobile_items-text">模式匹配</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#本地函数"><span class="toc_mobile_items-number">7.4.</span> <span class="toc_mobile_items-text">本地函数</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#更多的expression-bodied成员"><span class="toc_mobile_items-number">7.5.</span> <span class="toc_mobile_items-text">更多的expression-bodied成员</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Ref-局部变量和返回结果"><span class="toc_mobile_items-number">7.6.</span> <span class="toc_mobile_items-text">Ref 局部变量和返回结果</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#弃元"><span class="toc_mobile_items-number">7.7.</span> <span class="toc_mobile_items-text">弃元</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#二进制文本和数字分隔符"><span class="toc_mobile_items-number">7.8.</span> <span class="toc_mobile_items-text">二进制文本和数字分隔符</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#引发表达式"><span class="toc_mobile_items-number">7.9.</span> <span class="toc_mobile_items-text">引发表达式</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#C-8-0版-2019"><span class="toc_mobile_items-number">8.</span> <span class="toc_mobile_items-text">C# 8.0版 - 2019</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Readonly-成员"><span class="toc_mobile_items-number">8.1.</span> <span class="toc_mobile_items-text">Readonly 成员</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#默认接口方法"><span class="toc_mobile_items-number">8.2.</span> <span class="toc_mobile_items-text">默认接口方法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#在更多位置中使用更多模式"><span class="toc_mobile_items-number">8.3.</span> <span class="toc_mobile_items-text">在更多位置中使用更多模式</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#switch表达式"><span class="toc_mobile_items-number">8.3.1.</span> <span class="toc_mobile_items-text">* switch表达式</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#属性模式"><span class="toc_mobile_items-number">8.3.2.</span> <span class="toc_mobile_items-text">* 属性模式</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#元组模式"><span class="toc_mobile_items-number">8.3.3.</span> <span class="toc_mobile_items-text">* 元组模式</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#位置模式"><span class="toc_mobile_items-number">8.3.4.</span> <span class="toc_mobile_items-text">* 位置模式</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#using声明"><span class="toc_mobile_items-number">8.4.</span> <span class="toc_mobile_items-text">using声明</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#静态本地函数"><span class="toc_mobile_items-number">8.5.</span> <span class="toc_mobile_items-text">静态本地函数</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#异步流"><span class="toc_mobile_items-number">8.6.</span> <span class="toc_mobile_items-text">异步流</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#索引和范围"><span class="toc_mobile_items-number">8.7.</span> <span class="toc_mobile_items-text">索引和范围</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Null合并赋值"><span class="toc_mobile_items-number">8.8.</span> <span class="toc_mobile_items-text">Null合并赋值</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#非托管构造类型"><span class="toc_mobile_items-number">8.9.</span> <span class="toc_mobile_items-text">非托管构造类型</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#嵌套表达式中的-stackalloc"><span class="toc_mobile_items-number">8.10.</span> <span class="toc_mobile_items-text">嵌套表达式中的 stackalloc</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#代码演示C-各版本新功能"><span class="toc-number">1.</span> <span class="toc-text">代码演示C#各版本新功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C-2-0版-2005"><span class="toc-number">2.</span> <span class="toc-text">C# 2.0版 - 2005</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#泛型"><span class="toc-number">2.1.</span> <span class="toc-text">泛型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#分部类型"><span class="toc-number">2.2.</span> <span class="toc-text">分部类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#匿名方法"><span class="toc-number">2.3.</span> <span class="toc-text">匿名方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#可以为null的值类型"><span class="toc-number">2.4.</span> <span class="toc-text">可以为null的值类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#迭代器"><span class="toc-number">2.5.</span> <span class="toc-text">迭代器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#协变和逆变"><span class="toc-number">2.6.</span> <span class="toc-text">协变和逆变</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C-3-0版-2007"><span class="toc-number">3.</span> <span class="toc-text">C# 3.0版 - 2007</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#自动实现的属性"><span class="toc-number">3.1.</span> <span class="toc-text">自动实现的属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#匿名类型"><span class="toc-number">3.2.</span> <span class="toc-text">匿名类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查询表达式（LINQ）"><span class="toc-number">3.3.</span> <span class="toc-text">查询表达式（LINQ）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Lambda表达式"><span class="toc-number">3.4.</span> <span class="toc-text">Lambda表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#表达式树"><span class="toc-number">3.5.</span> <span class="toc-text">表达式树</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#扩展方法"><span class="toc-number">3.6.</span> <span class="toc-text">扩展方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#var"><span class="toc-number">3.7.</span> <span class="toc-text">var</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#分部方法"><span class="toc-number">3.8.</span> <span class="toc-text">分部方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#对象和集合初始值设定项"><span class="toc-number">3.9.</span> <span class="toc-text">对象和集合初始值设定项</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C-4-0版-2010"><span class="toc-number">4.</span> <span class="toc-text">C# 4.0版 - 2010</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#动态绑定"><span class="toc-number">4.1.</span> <span class="toc-text">动态绑定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#命名参数-可选参数"><span class="toc-number">4.2.</span> <span class="toc-text">命名参数&#x2F;可选参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#泛型中的协变和逆变"><span class="toc-number">4.3.</span> <span class="toc-text">泛型中的协变和逆变</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#类型等效性和嵌入的互操作类型"><span class="toc-number">4.4.</span> <span class="toc-text">类型等效性和嵌入的互操作类型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C-5-0版-2012"><span class="toc-number">5.</span> <span class="toc-text">C# 5.0版 - 2012</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#异步编程"><span class="toc-number">5.1.</span> <span class="toc-text">异步编程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#调用方信息"><span class="toc-number">5.2.</span> <span class="toc-text">调用方信息</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C-6-0版-2015"><span class="toc-number">6.</span> <span class="toc-text">C# 6.0版 - 2015</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#静态导入"><span class="toc-number">6.1.</span> <span class="toc-text">静态导入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#异常筛选器"><span class="toc-number">6.2.</span> <span class="toc-text">异常筛选器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#自动初始化表达式"><span class="toc-number">6.3.</span> <span class="toc-text">自动初始化表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Expression-bodied-函数成员"><span class="toc-number">6.4.</span> <span class="toc-text">Expression-bodied 函数成员</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Null传播器"><span class="toc-number">6.5.</span> <span class="toc-text">Null传播器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#字符串内插"><span class="toc-number">6.6.</span> <span class="toc-text">字符串内插</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nameof表达式"><span class="toc-number">6.7.</span> <span class="toc-text">nameof表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#索引初始值设定项"><span class="toc-number">6.8.</span> <span class="toc-text">索引初始值设定项</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C-7-0版-2017"><span class="toc-number">7.</span> <span class="toc-text">C# 7.0版 - 2017</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#out变量"><span class="toc-number">7.1.</span> <span class="toc-text">out变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#元组和析构函数"><span class="toc-number">7.2.</span> <span class="toc-text">元组和析构函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#模式匹配"><span class="toc-number">7.3.</span> <span class="toc-text">模式匹配</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#本地函数"><span class="toc-number">7.4.</span> <span class="toc-text">本地函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#更多的expression-bodied成员"><span class="toc-number">7.5.</span> <span class="toc-text">更多的expression-bodied成员</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ref-局部变量和返回结果"><span class="toc-number">7.6.</span> <span class="toc-text">Ref 局部变量和返回结果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#弃元"><span class="toc-number">7.7.</span> <span class="toc-text">弃元</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二进制文本和数字分隔符"><span class="toc-number">7.8.</span> <span class="toc-text">二进制文本和数字分隔符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#引发表达式"><span class="toc-number">7.9.</span> <span class="toc-text">引发表达式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C-8-0版-2019"><span class="toc-number">8.</span> <span class="toc-text">C# 8.0版 - 2019</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Readonly-成员"><span class="toc-number">8.1.</span> <span class="toc-text">Readonly 成员</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#默认接口方法"><span class="toc-number">8.2.</span> <span class="toc-text">默认接口方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#在更多位置中使用更多模式"><span class="toc-number">8.3.</span> <span class="toc-text">在更多位置中使用更多模式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#switch表达式"><span class="toc-number">8.3.1.</span> <span class="toc-text">* switch表达式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#属性模式"><span class="toc-number">8.3.2.</span> <span class="toc-text">* 属性模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#元组模式"><span class="toc-number">8.3.3.</span> <span class="toc-text">* 元组模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#位置模式"><span class="toc-number">8.3.4.</span> <span class="toc-text">* 位置模式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#using声明"><span class="toc-number">8.4.</span> <span class="toc-text">using声明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#静态本地函数"><span class="toc-number">8.5.</span> <span class="toc-text">静态本地函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#异步流"><span class="toc-number">8.6.</span> <span class="toc-text">异步流</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#索引和范围"><span class="toc-number">8.7.</span> <span class="toc-text">索引和范围</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Null合并赋值"><span class="toc-number">8.8.</span> <span class="toc-text">Null合并赋值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#非托管构造类型"><span class="toc-number">8.9.</span> <span class="toc-text">非托管构造类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#嵌套表达式中的-stackalloc"><span class="toc-number">8.10.</span> <span class="toc-text">嵌套表达式中的 stackalloc</span></a></li></ol></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(/img/logo/AspDotnet.png)"><div id="post-info"><div id="post-title"><div class="posttitle">一文看懂C#各版本新功能+代码演示</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 发表于 2020-03-01<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> 更新于 2020-03-01</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Asp-Net/">Asp.Net</a></span><div class="post-meta-wordcount"><div class="post-meta-pv-cv"><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>阅读量:</span><span id="busuanzi_value_page_pv"></span><span class="post-meta__separator">|</span><i class="fa fa-comments-o post-meta__icon fa-fw" aria-hidden="true"></i><span>评论数:</span><a href="/2020/03/01/%E4%B8%80%E6%96%87%E7%9C%8B%E6%87%82C-%E5%90%84%E7%89%88%E6%9C%AC%E6%96%B0%E5%8A%9F%E8%83%BD-%E4%BB%A3%E7%A0%81%E6%BC%94%E7%A4%BA/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2020/03/01/%E4%B8%80%E6%96%87%E7%9C%8B%E6%87%82C-%E5%90%84%E7%89%88%E6%9C%AC%E6%96%B0%E5%8A%9F%E8%83%BD-%E4%BB%A3%E7%A0%81%E6%BC%94%E7%A4%BA/" itemprop="commentCount"></span></a></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><html><head></head><body><h2 id="代码演示C-各版本新功能"><a href="#代码演示C-各版本新功能" class="headerlink" title="代码演示C#各版本新功能"></a>代码演示C#各版本新功能</h2><p>C#各版本新功能其实都能在官网搜到，但很少有人整理在一起，并通过非常简短的代码将每个新特性演示出来。</p>
<ul>
<li>代码演示C#各版本新功能</li>
<li>C# 2.0版 - 2005<ul>
<li>泛型</li>
<li>分部类型</li>
<li>匿名方法</li>
<li>可以为null的值类型</li>
<li>迭代器</li>
<li>协变和逆变</li>
</ul>
</li>
<li>C# 3.0版 - 2007<ul>
<li>自动实现的属性</li>
<li>匿名类型</li>
<li>查询表达式（LINQ）</li>
<li>Lambda表达式</li>
<li>表达式树</li>
<li>扩展方法</li>
<li>var</li>
<li>分部方法</li>
<li>对象和集合初始值设定项</li>
</ul>
</li>
<li>C# 4.0版 - 2010<ul>
<li>dynamic</li>
<li>命名参数/可选参数</li>
<li>泛型中的协变和逆变</li>
<li>类型等效、内置互操作类型</li>
</ul>
</li>
<li>C# 5.0版 - 2012<ul>
<li>async/await</li>
<li>调用方信息</li>
</ul>
</li>
<li>C# 6.0版 - 2015<ul>
<li>静态导入</li>
<li>异常筛选器</li>
<li>自动初始化表达式</li>
<li>Expression-bodied 函数成员</li>
<li>Null传播器</li>
<li>字符串内插</li>
<li>nameof表达式</li>
<li>索引初始值设定项</li>
</ul>
</li>
<li>C# 7.0版本 - 2017<ul>
<li>out变量</li>
<li>元组和析构函数</li>
<li>模式匹配</li>
<li>本地函数</li>
<li>更多的expression-bodied成员</li>
<li>Ref 局部变量和返回结果</li>
<li>弃元</li>
<li>二进制文本和数字分隔符</li>
<li>throw表达式</li>
</ul>
</li>
<li>C# 8.0 版 - 2019<ul>
<li>Readonly 成员</li>
<li>默认接口方法</li>
<li>模式匹配增强</li>
<li>属性模式</li>
<li>Tuple模式</li>
<li>位置模式</li>
<li>switch表达式</li>
<li>using声明</li>
<li>静态本地函数</li>
<li>异步流</li>
<li>索引和范围</li>
<li>Null合并赋值</li>
<li>非托管构造类型</li>
<li>嵌套表达式中的 stackalloc</li>
</ul>
</li>
<li>附录/总结</li>
</ul>
<h2 id="C-2-0版-2005"><a href="#C-2-0版-2005" class="headerlink" title="C# 2.0版 - 2005"></a>C# 2.0版 - 2005</h2><h3 id="泛型"><a href="#泛型" class="headerlink" title="泛型"></a>泛型</h3><p>Java中的泛型不支持值类型，且会运行时类型擦除，这一点 .NET更优秀。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">// Declare the generic class.</span><br><span class="line">public class GenericList<t></t></span><br><span class="line">{</span><br><span class="line">    public void Add(T input) { }</span><br><span class="line">}</span><br><span class="line">class TestGenericList</span><br><span class="line">{</span><br><span class="line">    private class ExampleClass { }</span><br><span class="line">    static void Main()</span><br><span class="line">    {</span><br><span class="line">        // Declare a list of type int.</span><br><span class="line">        GenericList<int> list1 = new GenericList<int>();</int></int></span><br><span class="line">        list1.Add(1);</span><br><span class="line"></span><br><span class="line">        // Declare a list of type string.</span><br><span class="line">        GenericList<string> list2 = new GenericList<string>();</string></string></span><br><span class="line">        list2.Add("");</span><br><span class="line"></span><br><span class="line">        // Declare a list of type ExampleClass.</span><br><span class="line">        GenericList<exampleclass> list3 = new GenericList<exampleclass>();</exampleclass></exampleclass></span><br><span class="line">        list3.Add(new ExampleClass());</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="分部类型"><a href="#分部类型" class="headerlink" title="分部类型"></a>分部类型</h3><blockquote>
<p>拆分一个类、一个结构、一个接口或一个方法的定义到两个或更多的文件中是可能的。 每个源文件包含类型或方法定义的一部分，编译应用程序时将把所有部分组合起来。</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public partial class Employee</span><br><span class="line">{</span><br><span class="line">    public void DoWork()</span><br><span class="line">    {</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">public partial class Employee</span><br><span class="line">{</span><br><span class="line">    public void GoToLunch()</span><br><span class="line">    {</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="匿名方法"><a href="#匿名方法" class="headerlink" title="匿名方法"></a>匿名方法</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Func<int, int, int> sum = delegate (int a, int b) { return a + b; };</int,></span><br><span class="line">Console.WriteLine(sum(3, 4));  // output: 7</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="可以为null的值类型"><a href="#可以为null的值类型" class="headerlink" title="可以为null的值类型"></a>可以为null的值类型</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">double? pi = 3.14;</span><br><span class="line">char? letter = 'a';</span><br><span class="line"></span><br><span class="line">int m2 = 10;</span><br><span class="line">int? m = m2;</span><br><span class="line"></span><br><span class="line">bool? flag = null;</span><br><span class="line"></span><br><span class="line">// An array of a nullable type:</span><br><span class="line">int?[] arr = new int?[10];</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="迭代器"><a href="#迭代器" class="headerlink" title="迭代器"></a>迭代器</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">static void Main()</span><br><span class="line">{</span><br><span class="line">    foreach (int number in SomeNumbers())</span><br><span class="line">    {</span><br><span class="line">        Console.Write(number.ToString() + " ");</span><br><span class="line">    }</span><br><span class="line">    // Output: 3 5 8</span><br><span class="line">    Console.ReadKey();</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">public static System.Collections.IEnumerable SomeNumbers()</span><br><span class="line">{</span><br><span class="line">    yield return 3;</span><br><span class="line">    yield return 5;</span><br><span class="line">    yield return 8;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="协变和逆变"><a href="#协变和逆变" class="headerlink" title="协变和逆变"></a>协变和逆变</h3><blockquote>
<p>在 C# 中，协变和逆变能够实现数组类型、委托类型和泛型类型参数的隐式引用转换。 协变保留分配兼容性，逆变则与之相反。</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">// Assignment compatibility.   </span><br><span class="line">string str = "test";  </span><br><span class="line">// An object of a more derived type is assigned to an object of a less derived type.   </span><br><span class="line">object obj = str;  </span><br><span class="line">  </span><br><span class="line">// Covariance.   </span><br><span class="line">IEnumerable<string> strings = new List<string>();  </string></string></span><br><span class="line">// An object that is instantiated with a more derived type argument   </span><br><span class="line">// is assigned to an object instantiated with a less derived type argument.   </span><br><span class="line">// Assignment compatibility is preserved.   </span><br><span class="line">IEnumerable<object> objects = strings;  <br><span class="line">  </span><br><span class="line">// Contravariance.             </span><br><span class="line">// Assume that the following method is in the class:   </span><br><span class="line">// static void SetObject(object o) { }   </span><br><span class="line">Action<object> actObject = SetObject;  <br><span class="line">// An object that is instantiated with a less derived type argument   </span><br><span class="line">// is assigned to an object instantiated with a more derived type argument.   </span><br><span class="line">// Assignment compatibility is reversed.   </span><br><span class="line">Action<string> actString = actObject;</string></span><br></object></span></object></span></pre></td></tr></tbody></table></figure></div>

<h2 id="C-3-0版-2007"><a href="#C-3-0版-2007" class="headerlink" title="C# 3.0版 - 2007"></a>C# 3.0版 - 2007</h2><h3 id="自动实现的属性"><a href="#自动实现的属性" class="headerlink" title="自动实现的属性"></a>自动实现的属性</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">// This class is mutable. Its data can be modified from</span><br><span class="line">// outside the class.</span><br><span class="line">class Customer</span><br><span class="line">{</span><br><span class="line">    // Auto-implemented properties for trivial get and set</span><br><span class="line">    public double TotalPurchases { get; set; }</span><br><span class="line">    public string Name { get; set; }</span><br><span class="line">    public int CustomerID { get; set; }</span><br><span class="line"></span><br><span class="line">    // Constructor</span><br><span class="line">    public Customer(double purchases, string name, int ID)</span><br><span class="line">    {</span><br><span class="line">        TotalPurchases = purchases;</span><br><span class="line">        Name = name;</span><br><span class="line">        CustomerID = ID;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    // Methods</span><br><span class="line">    public string GetContactInfo() { return "ContactInfo"; }</span><br><span class="line">    public string GetTransactionHistory() { return "History"; }</span><br><span class="line"></span><br><span class="line">    // .. Additional methods, events, etc.</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">class Program</span><br><span class="line">{</span><br><span class="line">    static void Main()</span><br><span class="line">    {</span><br><span class="line">        // Intialize a new object.</span><br><span class="line">        Customer cust1 = new Customer(4987.63, "Northwind", 90108);</span><br><span class="line"></span><br><span class="line">        // Modify a property.</span><br><span class="line">        cust1.TotalPurchases += 499.99;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="匿名类型"><a href="#匿名类型" class="headerlink" title="匿名类型"></a>匿名类型</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">var v = new { Amount = 108, Message = "Hello" };  </span><br><span class="line">  </span><br><span class="line">// Rest the mouse pointer over v.Amount and v.Message in the following  </span><br><span class="line">// statement to verify that their inferred types are int and n .  </span><br><span class="line">Console.WriteLine(v.Amount + v.Message);</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="查询表达式（LINQ）"><a href="#查询表达式（LINQ）" class="headerlink" title="查询表达式（LINQ）"></a>查询表达式（LINQ）</h3><blockquote>
<p>我们通常认为 C# 版本的杀手锏是查询表达式，也就是语言集成查询 (LINQ)。<br>LINQ 的构造可以建立在更细微的视图检查表达式树、Lambda 表达式以及匿名类型的基础上。 不过无论如何 C# 3.0 都提出了革命性的概念。 C# 3.0 开始为 C# 转变为面向对象/函数式混合语言打下基础。<br>具体来说，你现在可以编写 SQL 样式的声明性查询对集合以及其他项目执行操作。</p>
</blockquote>
<h3 id="Lambda表达式"><a href="#Lambda表达式" class="headerlink" title="Lambda表达式"></a>Lambda表达式</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">Func<int, int> square = x => x * x;</int,></span><br><span class="line">Console.WriteLine(square(5));</span><br><span class="line">// Output:</span><br><span class="line">// 25</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="表达式树"><a href="#表达式树" class="headerlink" title="表达式树"></a>表达式树</h3><h3 id="扩展方法"><a href="#扩展方法" class="headerlink" title="扩展方法"></a>扩展方法</h3><blockquote>
<p>扩展方法使你能够向现有类型“添加”方法，而无需创建新的派生类型、重新编译或以其他方式修改原始类型。</p>
</blockquote>
<h3 id="var"><a href="#var" class="headerlink" title="var"></a>var</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">var i = 10; // Implicitly typed.</span><br><span class="line">int i = 10; // Explicitly typed.</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="分部方法"><a href="#分部方法" class="headerlink" title="分部方法"></a>分部方法</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">namespace PM</span><br><span class="line">{</span><br><span class="line">    partial class A</span><br><span class="line">    {</span><br><span class="line">        partial void OnSomethingHappened(string s);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    // This part can be in a separate file.</span><br><span class="line">    partial class A</span><br><span class="line">    {</span><br><span class="line">        // Comment out this method and the program</span><br><span class="line">        // will still compile.</span><br><span class="line">        partial void OnSomethingHappened(String s)</span><br><span class="line">        {</span><br><span class="line">            Console.WriteLine("Something happened: {0}", s);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="对象和集合初始值设定项"><a href="#对象和集合初始值设定项" class="headerlink" title="对象和集合初始值设定项"></a>对象和集合初始值设定项</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public class Cat</span><br><span class="line">{</span><br><span class="line">    // Auto-implemented properties.</span><br><span class="line">    public int Age { get; set; }</span><br><span class="line">    public string Name { get; set; }</span><br><span class="line"></span><br><span class="line">    public Cat()</span><br><span class="line">    {</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public Cat(string name)</span><br><span class="line">    {</span><br><span class="line">        this.Name = name;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

<h2 id="C-4-0版-2010"><a href="#C-4-0版-2010" class="headerlink" title="C# 4.0版 - 2010"></a>C# 4.0版 - 2010</h2><h3 id="动态绑定"><a href="#动态绑定" class="headerlink" title="动态绑定"></a>动态绑定</h3><h3 id="命名参数-可选参数"><a href="#命名参数-可选参数" class="headerlink" title="命名参数/可选参数"></a>命名参数/可选参数</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">PrintOrderDetails(productName: "Red Mug", sellerName: "Gift Shop", orderNum: 31);</span><br><span class="line"></span><br><span class="line">public void ExampleMethod(int required, string optionalstr = "default string",</span><br><span class="line">    int optionalint = 10)</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="泛型中的协变和逆变"><a href="#泛型中的协变和逆变" class="headerlink" title="泛型中的协变和逆变"></a>泛型中的协变和逆变</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">IEnumerable<derived> d = new List<derived>();</derived></derived></span><br><span class="line">IEnumerable<base> b = d;</span><br><span class="line"></span><br><span class="line">Action<base> b = (target) => { Console.WriteLine(target.GetType().Name); };</span><br><span class="line">Action<derived> d = b;</derived></span><br><span class="line">d(new Derived());</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="类型等效性和嵌入的互操作类型"><a href="#类型等效性和嵌入的互操作类型" class="headerlink" title="类型等效性和嵌入的互操作类型"></a>类型等效性和嵌入的互操作类型</h3><h2 id="C-5-0版-2012"><a href="#C-5-0版-2012" class="headerlink" title="C# 5.0版 - 2012"></a>C# 5.0版 - 2012</h2><h3 id="异步编程"><a href="#异步编程" class="headerlink" title="异步编程"></a>异步编程</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">private DamageResult CalculateDamageDone()</span><br><span class="line">{</span><br><span class="line">    // Code omitted:</span><br><span class="line">    //</span><br><span class="line">    // Does an expensive calculation and returns</span><br><span class="line">    // the result of that calculation.</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">calculateButton.Clicked += async (o, e) =></span><br><span class="line">{</span><br><span class="line">    // This line will yield control to the UI while CalculateDamageDone()</span><br><span class="line">    // performs its work.  The UI thread is free to perform other work.</span><br><span class="line">    var damageResult = await Task.Run(() => CalculateDamageDone());</span><br><span class="line">    DisplayDamage(damageResult);</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="调用方信息"><a href="#调用方信息" class="headerlink" title="调用方信息"></a>调用方信息</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public void DoProcessing()</span><br><span class="line">{</span><br><span class="line">    TraceMessage("Something happened.");</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">public void TraceMessage(string message,</span><br><span class="line">        [System.Runtime.CompilerServices.CallerMemberName] string memberName = "",</span><br><span class="line">        [System.Runtime.CompilerServices.CallerFilePath] string sourceFilePath = "",</span><br><span class="line">        [System.Runtime.CompilerServices.CallerLineNumber] int sourceLineNumber = 0)</span><br><span class="line">{</span><br><span class="line">    System.Diagnostics.Trace.WriteLine("message: " + message);</span><br><span class="line">    System.Diagnostics.Trace.WriteLine("member name: " + memberName);</span><br><span class="line">    System.Diagnostics.Trace.WriteLine("source file path: " + sourceFilePath);</span><br><span class="line">    System.Diagnostics.Trace.WriteLine("source line number: " + sourceLineNumber);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">// Sample Output:</span><br><span class="line">//  message: Something happened.</span><br><span class="line">//  member name: DoProcessing</span><br><span class="line">//  source file path: c:\Visual Studio Projects\CallerInfoCS\CallerInfoCS\Form1.cs</span><br><span class="line">//  source line number: 31</span><br></pre></td></tr></tbody></table></figure></div>

<h2 id="C-6-0版-2015"><a href="#C-6-0版-2015" class="headerlink" title="C# 6.0版 - 2015"></a>C# 6.0版 - 2015</h2><h3 id="静态导入"><a href="#静态导入" class="headerlink" title="静态导入"></a>静态导入</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">using static System.Math;</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="异常筛选器"><a href="#异常筛选器" class="headerlink" title="异常筛选器"></a>异常筛选器</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public static async Task<string> MakeRequest()</string></span><br><span class="line">{</span><br><span class="line">    WebRequestHandler webRequestHandler = new WebRequestHandler();</span><br><span class="line">    webRequestHandler.AllowAutoRedirect = false;</span><br><span class="line">    using (HttpClient client = new HttpClient(webRequestHandler))</span><br><span class="line">    {</span><br><span class="line">        var stringTask = client.GetStringAsync("https://docs.microsoft.com/en-us/dotnet/about/");</span><br><span class="line">        try</span><br><span class="line">        {</span><br><span class="line">            var responseText = await stringTask;</span><br><span class="line">            return responseText;</span><br><span class="line">        }</span><br><span class="line">        catch (System.Net.Http.HttpRequestException e) when (e.Message.Contains("301"))</span><br><span class="line">        {</span><br><span class="line">            return "Site Moved";</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="自动初始化表达式"><a href="#自动初始化表达式" class="headerlink" title="自动初始化表达式"></a>自动初始化表达式</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public ICollection<double> Grades { get; } = new List<double>();</double></double></span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="Expression-bodied-函数成员"><a href="#Expression-bodied-函数成员" class="headerlink" title="Expression-bodied 函数成员"></a>Expression-bodied 函数成员</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public override string ToString() => $"{LastName}, {FirstName}";</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="Null传播器"><a href="#Null传播器" class="headerlink" title="Null传播器"></a>Null传播器</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">var first = person?.FirstName;</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="字符串内插"><a href="#字符串内插" class="headerlink" title="字符串内插"></a>字符串内插</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public string GetGradePointPercentage() =></span><br><span class="line">    $"Name: {LastName}, {FirstName}. G.P.A: {Grades.Average():F2}";</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="nameof表达式"><a href="#nameof表达式" class="headerlink" title="nameof表达式"></a><code>nameof</code>表达式</h3><blockquote>
<p>nameof 表达式的计算结果为符号的名称。 每当需要变量、属性或成员字段的名称时，这是让工具正常运行的好办法。 nameof 的其中一个最常见的用途是提供引起异常的符号的名称：</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">if (IsNullOrWhiteSpace(lastName))</span><br><span class="line">    throw new ArgumentException(message: "Cannot be blank", paramName: nameof(lastName));</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="索引初始值设定项"><a href="#索引初始值设定项" class="headerlink" title="索引初始值设定项"></a>索引初始值设定项</h3><blockquote>
<p>使集合初始化更容易的另一个功能是对 Add 方法使用扩展方法 。 添加此功能的目的是进行 Visual Basic 的奇偶校验。 如果自定义集合类的方法具有通过语义方式添加新项的名称，则此功能非常有用。</p>
</blockquote>
<h2 id="C-7-0版-2017"><a href="#C-7-0版-2017" class="headerlink" title="C# 7.0版 - 2017"></a>C# 7.0版 - 2017</h2><h3 id="out变量"><a href="#out变量" class="headerlink" title="out变量"></a>out变量</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">if (int.TryParse(input, out int result))</span><br><span class="line">    Console.WriteLine(result);</span><br><span class="line">else</span><br><span class="line">    Console.WriteLine("Could not parse input");</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="元组和析构函数"><a href="#元组和析构函数" class="headerlink" title="元组和析构函数"></a>元组和析构函数</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">(string Alpha, string Beta) namedLetters = ("a", "b");</span><br><span class="line">Console.WriteLine($"{namedLetters.Alpha}, {namedLetters.Beta}");</span><br></pre></td></tr></tbody></table></figure></div>

<p>析构函数应该类似C++中的析构函数，在实例回收时执行？</p>
<h3 id="模式匹配"><a href="#模式匹配" class="headerlink" title="模式匹配"></a>模式匹配</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">if (input is int count)</span><br><span class="line">    sum += count;</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="本地函数"><a href="#本地函数" class="headerlink" title="本地函数"></a>本地函数</h3><p>也可用lambda代替</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public static IEnumerable<char> AlphabetSubset3(char start, char end)</char></span><br><span class="line">{</span><br><span class="line">    if (start < 'a' || start > 'z')</span><br><span class="line">        throw new ArgumentOutOfRangeException(paramName: nameof(start), message: "start must be a letter");</span><br><span class="line">    if (end < 'a' || end > 'z')</span><br><span class="line">        throw new ArgumentOutOfRangeException(paramName: nameof(end), message: "end must be a letter");</span><br><span class="line"></span><br><span class="line">    if (end <= start)</span><br><span class="line">        throw new ArgumentException($"{nameof(end)} must be greater than {nameof(start)}");</span><br><span class="line"></span><br><span class="line">    return alphabetSubsetImplementation();</span><br><span class="line"></span><br><span class="line">    IEnumerable<char> alphabetSubsetImplementation()</char></span><br><span class="line">    {</span><br><span class="line">        for (var c = start; c < end; c++)</span><br><span class="line">            yield return c;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="更多的expression-bodied成员"><a href="#更多的expression-bodied成员" class="headerlink" title="更多的expression-bodied成员"></a>更多的expression-bodied成员</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">// Expression-bodied constructor</span><br><span class="line">public ExpressionMembersExample(string label) => this.Label = label;</span><br><span class="line"></span><br><span class="line">// Expression-bodied finalizer</span><br><span class="line">~ExpressionMembersExample() => Console.Error.WriteLine("Finalized!");</span><br><span class="line"></span><br><span class="line">private string label;</span><br><span class="line"></span><br><span class="line">// Expression-bodied get / set accessors.</span><br><span class="line">public string Label</span><br><span class="line">{</span><br><span class="line">    get => label;</span><br><span class="line">    set => this.label = value ?? "Default label";</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="Ref-局部变量和返回结果"><a href="#Ref-局部变量和返回结果" class="headerlink" title="Ref 局部变量和返回结果"></a>Ref 局部变量和返回结果</h3><blockquote>
<p>此功能允许使用并返回对变量的引用的算法，这些变量在其他位置定义。 一个示例是使用大型矩阵并查找具有某些特征的单个位置。</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public static ref int Find(int[,] matrix, Func<int, bool> predicate)</int,></span><br><span class="line">{</span><br><span class="line">    for (int i = 0; i < matrix.GetLength(0); i++)</span><br><span class="line">        for (int j = 0; j < matrix.GetLength(1); j++)</span><br><span class="line">            if (predicate(matrix[i, j]))</span><br><span class="line">                return ref matrix[i, j];</span><br><span class="line">    throw new InvalidOperationException("Not found");</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ref var item = ref MatrixSearch.Find(matrix, (val) => val == 42);</span><br><span class="line">Console.WriteLine(item);</span><br><span class="line">item = 24;</span><br><span class="line">Console.WriteLine(matrix[4, 2]);</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="弃元"><a href="#弃元" class="headerlink" title="弃元"></a>弃元</h3><h3 id="二进制文本和数字分隔符"><a href="#二进制文本和数字分隔符" class="headerlink" title="二进制文本和数字分隔符"></a>二进制文本和数字分隔符</h3><h3 id="引发表达式"><a href="#引发表达式" class="headerlink" title="引发表达式"></a>引发表达式</h3><h2 id="C-8-0版-2019"><a href="#C-8-0版-2019" class="headerlink" title="C# 8.0版 - 2019"></a>C# 8.0版 - 2019</h2><h3 id="Readonly-成员"><a href="#Readonly-成员" class="headerlink" title="Readonly 成员"></a>Readonly 成员</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public readonly override string ToString() =></span><br><span class="line">    $"({X}, {Y}) is {Distance} from the origin";</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="默认接口方法"><a href="#默认接口方法" class="headerlink" title="默认接口方法"></a>默认接口方法</h3><h3 id="在更多位置中使用更多模式"><a href="#在更多位置中使用更多模式" class="headerlink" title="在更多位置中使用更多模式"></a>在更多位置中使用更多模式</h3><h4 id="switch表达式"><a href="#switch表达式" class="headerlink" title="* switch表达式"></a>* switch表达式</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public static RGBColor FromRainbow(Rainbow colorBand) =></span><br><span class="line">    colorBand switch</span><br><span class="line">    {</span><br><span class="line">        Rainbow.Red    => new RGBColor(0xFF, 0x00, 0x00),</span><br><span class="line">        Rainbow.Orange => new RGBColor(0xFF, 0x7F, 0x00),</span><br><span class="line">        Rainbow.Yellow => new RGBColor(0xFF, 0xFF, 0x00),</span><br><span class="line">        Rainbow.Green  => new RGBColor(0x00, 0xFF, 0x00),</span><br><span class="line">        Rainbow.Blue   => new RGBColor(0x00, 0x00, 0xFF),</span><br><span class="line">        Rainbow.Indigo => new RGBColor(0x4B, 0x00, 0x82),</span><br><span class="line">        Rainbow.Violet => new RGBColor(0x94, 0x00, 0xD3),</span><br><span class="line">        _              => throw new ArgumentException(message: "invalid enum value", paramName: nameof(colorBand)),</span><br><span class="line">    };</span><br></pre></td></tr></tbody></table></figure></div>

<h4 id="属性模式"><a href="#属性模式" class="headerlink" title="* 属性模式"></a>* 属性模式</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public static decimal ComputeSalesTax(Address location, decimal salePrice) =></span><br><span class="line">    location switch</span><br><span class="line">    {</span><br><span class="line">        { State: "WA" } => salePrice * 0.06M,</span><br><span class="line">        { State: "MN" } => salePrice * 0.75M,</span><br><span class="line">        { State: "MI" } => salePrice * 0.05M,</span><br><span class="line">        // other cases removed for brevity...</span><br><span class="line">        _ => 0M</span><br><span class="line">    };</span><br></pre></td></tr></tbody></table></figure></div>

<h4 id="元组模式"><a href="#元组模式" class="headerlink" title="* 元组模式"></a>* 元组模式</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public static string RockPaperScissors(string first, string second)</span><br><span class="line">    => (first, second) switch</span><br><span class="line">    {</span><br><span class="line">        ("rock", "paper") => "rock is covered by paper. Paper wins.",</span><br><span class="line">        ("rock", "scissors") => "rock breaks scissors. Rock wins.",</span><br><span class="line">        ("paper", "rock") => "paper covers rock. Paper wins.",</span><br><span class="line">        ("paper", "scissors") => "paper is cut by scissors. Scissors wins.",</span><br><span class="line">        ("scissors", "rock") => "scissors is broken by rock. Rock wins.",</span><br><span class="line">        ("scissors", "paper") => "scissors cuts paper. Scissors wins.",</span><br><span class="line">        (_, _) => "tie"</span><br><span class="line">    };</span><br></pre></td></tr></tbody></table></figure></div>


<h4 id="位置模式"><a href="#位置模式" class="headerlink" title="* 位置模式"></a>* 位置模式</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">static Quadrant GetQuadrant(Point point) => point switch</span><br><span class="line">{</span><br><span class="line">    (0, 0) => Quadrant.Origin,</span><br><span class="line">    var (x, y) when x > 0 && y > 0 => Quadrant.One,</span><br><span class="line">    var (x, y) when x < 0 && y > 0 => Quadrant.Two,</span><br><span class="line">    var (x, y) when x < 0 && y < 0 => Quadrant.Three,</span><br><span class="line">    var (x, y) when x > 0 && y < 0 => Quadrant.Four,</span><br><span class="line">    var (_, _) => Quadrant.OnBorder,</span><br><span class="line">    _ => Quadrant.Unknown</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="using声明"><a href="#using声明" class="headerlink" title="using声明"></a>using声明</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">static int WriteLinesToFile(IEnumerable<string> lines)</string></span><br><span class="line">{</span><br><span class="line">    using var file = new System.IO.StreamWriter("WriteLines2.txt");</span><br><span class="line">    // Notice how we declare skippedLines after the using statement.</span><br><span class="line">    int skippedLines = 0;</span><br><span class="line">    foreach (string line in lines)</span><br><span class="line">    {</span><br><span class="line">        if (!line.Contains("Second"))</span><br><span class="line">        {</span><br><span class="line">            file.WriteLine(line);</span><br><span class="line">        }</span><br><span class="line">        else</span><br><span class="line">        {</span><br><span class="line">            skippedLines++;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    // Notice how skippedLines is in scope here.</span><br><span class="line">    return skippedLines;</span><br><span class="line">    // file is disposed here</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="静态本地函数"><a href="#静态本地函数" class="headerlink" title="静态本地函数"></a>静态本地函数</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">int M()</span><br><span class="line">{</span><br><span class="line">    int y = 5;</span><br><span class="line">    int x = 7;</span><br><span class="line">    return Add(x, y);</span><br><span class="line"></span><br><span class="line">    static int Add(int left, int right) => left + right;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="异步流"><a href="#异步流" class="headerlink" title="异步流"></a>异步流</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public static async System.Collections.Generic.IAsyncEnumerable<int> GenerateSequence()</int></span><br><span class="line">{</span><br><span class="line">    for (int i = 0; i < 20; i++)</span><br><span class="line">    {</span><br><span class="line">        await Task.Delay(100);</span><br><span class="line">        yield return i;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="索引和范围"><a href="#索引和范围" class="headerlink" title="索引和范围"></a>索引和范围</h3><p>感觉类似python中的切片器，<code>-</code>用<code>^</code>代替了</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">var words = new string[]</span><br><span class="line">{</span><br><span class="line">                // index from start    index from end</span><br><span class="line">    "The",      // 0                   ^9</span><br><span class="line">    "quick",    // 1                   ^8</span><br><span class="line">    "brown",    // 2                   ^7</span><br><span class="line">    "fox",      // 3                   ^6</span><br><span class="line">    "jumped",   // 4                   ^5</span><br><span class="line">    "over",     // 5                   ^4</span><br><span class="line">    "the",      // 6                   ^3</span><br><span class="line">    "lazy",     // 7                   ^2</span><br><span class="line">    "dog"       // 8                   ^1</span><br><span class="line">};              // 9 (or words.Length) ^0</span><br><span class="line"></span><br><span class="line">var quickBrownFox = words[1..4];</span><br><span class="line">var lazyDog = words[^2..^0];</span><br><span class="line">var allWords = words[..]; // contains "The" through "dog".</span><br><span class="line">var firstPhrase = words[..4]; // contains "The" through "fox"</span><br><span class="line">var lastPhrase = words[6..]; // contains "the", "lazy" and "dog"</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="Null合并赋值"><a href="#Null合并赋值" class="headerlink" title="Null合并赋值"></a>Null合并赋值</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">List<int> numbers = null;</int></span><br><span class="line">int? i = null;</span><br><span class="line"></span><br><span class="line">numbers ??= new List<int>();</int></span><br><span class="line">numbers.Add(i ??= 17);</span><br><span class="line">numbers.Add(i ??= 20);</span><br><span class="line"></span><br><span class="line">Console.WriteLine(string.Join(" ", numbers));  // output: 17 17</span><br><span class="line">Console.WriteLine(i);  // output: 17</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="非托管构造类型"><a href="#非托管构造类型" class="headerlink" title="非托管构造类型"></a>非托管构造类型</h3><blockquote>
<p>与任何非托管类型一样，可以创建指向此类型的变量的指针，或针对此类型的实例在堆栈上分配内存块</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Span<coords<int>> coordinates = stackalloc[]</coords<int></span><br><span class="line">{</span><br><span class="line">    new Coords<int> { X = 0, Y = 0 },</int></span><br><span class="line">    new Coords<int> { X = 0, Y = 3 },</int></span><br><span class="line">    new Coords<int> { X = 4, Y = 0 }</int></span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="嵌套表达式中的-stackalloc"><a href="#嵌套表达式中的-stackalloc" class="headerlink" title="嵌套表达式中的 stackalloc"></a>嵌套表达式中的 stackalloc</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Span<int> numbers = stackalloc[] { 1, 2, 3, 4, 5, 6 };</int></span><br><span class="line">var ind = numbers.IndexOfAny(stackalloc[] { 2, 4, 6 ,8 });</span><br><span class="line">Console.WriteLine(ind);  // output: 1</span><br></pre></td></tr></tbody></table></figure></div>



<blockquote>
<p>原文链接：<a href="https://akiyax.github.io/new-features-in-csharp" target="_blank" rel="noopener">Akiya Xiao：《C# 各版本新功能列表》</a><br>参考资料：<a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/whats-new/csharp-version-history" target="_blank" rel="noopener">《C#发展历史 - C#指南》</a></p>
</blockquote>
</body></html></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">HJY</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://hjy-dev.github.io/2020/03/01/%E4%B8%80%E6%96%87%E7%9C%8B%E6%87%82C-%E5%90%84%E7%89%88%E6%9C%AC%E6%96%B0%E5%8A%9F%E8%83%BD-%E4%BB%A3%E7%A0%81%E6%BC%94%E7%A4%BA/">https://hjy-dev.github.io/2020/03/01/%E4%B8%80%E6%96%87%E7%9C%8B%E6%87%82C-%E5%90%84%E7%89%88%E6%9C%AC%E6%96%B0%E5%8A%9F%E8%83%BD-%E4%BB%A3%E7%A0%81%E6%BC%94%E7%A4%BA/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">Apache License 2.0</a> 许可协议。转载请注明来自 <a href="https://Hjy-dev.github.io">Anmi Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Asp-Net/">Asp.Net    </a><a class="post-meta__tags" href="/tags/C/">C#    </a></div><div class="post_share"><div class="social-share" data-image="/img/logo/AspDotnet.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg" alt="微信"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="next-post pull-full"><a href="/2020/03/01/Mysql%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/"><img class="next_cover lazyload" data-src="/img/logo/mysql.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>Mysql知识总结</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/02/23/WCF、WebAPI、WCFREST、WebService之间的区别/" title="WCF、WebAPI、WCFREST、WebService之间的区别"><img class="relatedPosts_cover lazyload"data-src="/img/logo/AspDotnet.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-02-23</div><div class="relatedPosts_title">WCF、WebAPI、WCFREST、WebService之间的区别</div></div></a></div><div class="relatedPosts_item"><a href="/2020/02/23/Asp-Net之string-Join使用/" title="Asp.Net之string.Join使用"><img class="relatedPosts_cover lazyload"data-src="/img/logo/AspDotnet.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-02-23</div><div class="relatedPosts_title">Asp.Net之string.Join使用</div></div></a></div><div class="relatedPosts_item"><a href="/2020/02/23/HTTP协议详解/" title="HTTP协议详解"><img class="relatedPosts_cover lazyload"data-src="/img/logo/http.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-02-23</div><div class="relatedPosts_title">HTTP协议详解</div></div></a></div><div class="relatedPosts_item"><a href="/2020/02/26/位运算与逻辑运算/" title="位运算与逻辑运算"><img class="relatedPosts_cover lazyload"data-src="/img/logo/AspDotnet.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-02-26</div><div class="relatedPosts_title">位运算与逻辑运算</div></div></a></div><div class="relatedPosts_item"><a href="/2020/02/23/支付宝沙箱环境搭建/" title="支付宝沙箱环境搭建"><img class="relatedPosts_cover lazyload"data-src="/img/logo/pay.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-02-23</div><div class="relatedPosts_title">支付宝沙箱环境搭建</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = false == true ? true : false;
var verify = false == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'07krhbf5QmfXvJ74VmydIejf-gzGzoHsz',
  appKey:'Jo4RMgCd4RncyC5AyoDaxcFB',
  placeholder:'给我的文章加点评论吧~',
  avatar:'monsterid',
  guest_info:guest_info,
  pageSize:'10',
  lang:'zh-cn',
  recordIP: true
});</script></div></div></main><footer id="footer" style="background-image: url(/img/logo/AspDotnet.png)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2020 By HJY</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>